{"ast":null,"code":"import { UserEditComponent } from '../user-edit/user-edit.component';\nimport { DirectorCardComponent } from '../director-card/director-card.component';\nimport { GenreCardComponent } from '../genre-card/genre-card.component';\nimport { SynopsisCardComponent } from '../synopsis-card/synopsis-card.component';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../fetch-api-data.service\";\nimport * as i2 from \"@angular/material/snack-bar\";\nimport * as i3 from \"@angular/material/dialog\";\nimport * as i4 from \"@angular/router\";\nimport * as i5 from \"../navbar/navbar.component\";\nimport * as i6 from \"@angular/material/card\";\nimport * as i7 from \"@angular/material/button\";\nimport * as i8 from \"@angular/common\";\n\nfunction ProfileViewComponent_div_28_mat_card_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"mat-card\")(1, \"mat-dialog-content\")(2, \"mat-card-title\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"mat-card-subtitle\");\n    i0.ɵɵelement(5, \"img\", 10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"mat-card-header\")(7, \"button\", 11);\n    i0.ɵɵlistener(\"click\", function ProfileViewComponent_div_28_mat_card_3_Template_button_click_7_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r7);\n      const movie_r4 = restoredCtx.$implicit;\n      const ctx_r6 = i0.ɵɵnextContext(2);\n      return ctx_r6.openDirectorDialog(movie_r4.Director.Name, movie_r4.Director.Bio, movie_r4.Director.Birth);\n    });\n    i0.ɵɵtext(8, \" Director Details \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"button\", 12);\n    i0.ɵɵlistener(\"click\", function ProfileViewComponent_div_28_mat_card_3_Template_button_click_9_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r7);\n      const movie_r4 = restoredCtx.$implicit;\n      const ctx_r8 = i0.ɵɵnextContext(2);\n      return ctx_r8.openGenreDialog(movie_r4.Genre.Name, movie_r4.Genre.Description);\n    });\n    i0.ɵɵtext(10, \" Genre Details \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"button\", 13);\n    i0.ɵɵlistener(\"click\", function ProfileViewComponent_div_28_mat_card_3_Template_button_click_11_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r7);\n      const movie_r4 = restoredCtx.$implicit;\n      const ctx_r9 = i0.ɵɵnextContext(2);\n      return ctx_r9.openSynopsis(movie_r4.Title, movie_r4.ImagePath, movie_r4.Description);\n    });\n    i0.ɵɵtext(12, \" Synopsis \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"button\", 14);\n    i0.ɵɵlistener(\"click\", function ProfileViewComponent_div_28_mat_card_3_Template_button_click_13_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r7);\n      const movie_r4 = restoredCtx.$implicit;\n      const ctx_r10 = i0.ɵɵnextContext(2);\n      return ctx_r10.removeFav(movie_r4._id);\n    });\n    i0.ɵɵtext(14, \" Delete Favorite Movie \");\n    i0.ɵɵelementEnd()()()();\n  }\n\n  if (rf & 2) {\n    const movie_r4 = ctx.$implicit;\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(movie_r4.title);\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate(\"src\", movie_r4.ImagePath, i0.ɵɵsanitizeUrl);\n  }\n}\n\nfunction ProfileViewComponent_div_28_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\")(1, \"h2\");\n    i0.ɵɵtext(2, \"Favourite movies\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(3, ProfileViewComponent_div_28_mat_card_3_Template, 15, 2, \"mat-card\", 9);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.favMovies);\n  }\n}\n\nfunction ProfileViewComponent_ng_template_29_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"h2\");\n    i0.ɵɵtext(1, \"You don't have any favourite movies in your list\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nexport let ProfileViewComponent = /*#__PURE__*/(() => {\n  class ProfileViewComponent {\n    constructor(fetchApiData, snackBar, dialog, router) {\n      this.fetchApiData = fetchApiData;\n      this.snackBar = snackBar;\n      this.dialog = dialog;\n      this.router = router;\n      this.user = {};\n      this.movies = [];\n      this.userName = localStorage.getItem('user');\n      this.favs = null;\n      this.favMovies = [];\n      this.displayElement = false;\n    }\n\n    ngOnInit() {\n      // this.getfavMovies()\n      this.getUser();\n      this.getFavs();\n    }\n\n    openSynopsis(title, imagePath, description) {\n      this.dialog.open(SynopsisCardComponent, {\n        data: {\n          Title: title,\n          ImagePath: imagePath,\n          Description: description\n        },\n        width: '500px'\n      });\n    }\n\n    openDirectorDialog(name, bio, birth) {\n      this.dialog.open(DirectorCardComponent, {\n        data: {\n          Name: name,\n          Bio: bio,\n          Birth: birth\n        },\n        width: '500px'\n      });\n    } // Open Genre View\n\n\n    openGenreDialog(name, description) {\n      this.dialog.open(GenreCardComponent, {\n        data: {\n          Name: name,\n          Description: description\n        },\n        width: '500px'\n      });\n    }\n\n    getUser() {\n      const user = localStorage.getItem('user');\n\n      if (user) {\n        this.fetchApiData.getUser(user).subscribe(resp => {\n          this.user = resp;\n          console.log(this.user);\n        });\n      }\n    }\n\n    openEditUserProfile() {\n      this.dialog.open(UserEditComponent, {\n        width: '500px'\n      });\n    }\n\n    getFavs() {\n      let movies = [];\n      this.fetchApiData.getAllMovies().subscribe(res => {\n        movies = res;\n        movies.forEach(movie => {\n          if (this.user.FavouriteMovies.includes(movie._id)) {\n            this.favMovies.push(movie);\n            this.displayElement = true;\n          }\n        });\n      });\n    } //Delete User account\n\n\n    deleteUserProfile() {\n      if (confirm('Are you sure? This cannot be undone.')) {\n        this.router.navigate(['welcome']).then(() => {\n          this.snackBar.open('Your account was deleted', 'OK', {\n            duration: 6000\n          });\n        });\n        this.router.navigate(['welcome']);\n        this.fetchApiData.deleteUserProfile().subscribe(() => {\n          localStorage.clear();\n        });\n      }\n    }\n\n    removeFav(id) {\n      this.fetchApiData.deleteFavMovie(id).subscribe(res => {\n        this.snackBar.open('Successfully removed from favorite movies.', 'OK', {\n          duration: 2000\n        });\n        this.ngOnInit();\n        return this.favs;\n      });\n    }\n\n  }\n\n  ProfileViewComponent.ɵfac = function ProfileViewComponent_Factory(t) {\n    return new (t || ProfileViewComponent)(i0.ɵɵdirectiveInject(i1.FetchApiDataService), i0.ɵɵdirectiveInject(i2.MatSnackBar), i0.ɵɵdirectiveInject(i3.MatDialog), i0.ɵɵdirectiveInject(i4.Router));\n  };\n\n  ProfileViewComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ProfileViewComponent,\n    selectors: [[\"app-profile-view\"]],\n    decls: 31,\n    vars: 6,\n    consts: [[1, \"profile-body\"], [1, \"profilebackground\"], [1, \"user-info\"], [2, \"font-style\", \"italic\", \"text-decoration\", \"underline\"], [\"mat-raised-button\", \"\", \"color\", \"primary\", 1, \"profile-btn\", 2, \"margin-right\", \"10px\", 3, \"click\"], [\"color\", \"warn\", \"mat-raised-button\", \"\", 1, \"profile-btn\", 3, \"click\"], [1, \"moviebox\"], [4, \"ngIf\", \"ngIfElse\"], [\"message\", \"\"], [4, \"ngFor\", \"ngForOf\"], [1, \"movie-image\", 3, \"src\"], [\"mat-button\", \"\", \"color\", \"grey\", 1, \"director-button\", 3, \"click\"], [\"mat-button\", \"\", \"color\", \"grey\", 1, \"genre-button\", 3, \"click\"], [\"mat-button\", \"\", \"color\", \"grey\", 1, \"synopsis-button\", 3, \"click\"], [\"mat-button\", \"\", \"color\", \"grey\", 1, \"delete-button\", 3, \"click\"]],\n    template: function ProfileViewComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelement(0, \"app-navbar\");\n        i0.ɵɵelementStart(1, \"div\", 0)(2, \"mat-card\", 1)(3, \"div\", 2)(4, \"h2\");\n        i0.ɵɵtext(5);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(6, \"h2\", 3);\n        i0.ɵɵtext(7, \" Your Profile Information \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(8, \"mat-card-header\");\n        i0.ɵɵelementStart(9, \"mat-card-content\")(10, \"h3\")(11, \"b\");\n        i0.ɵɵtext(12, \"Username: \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(13);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(14, \"h3\")(15, \"b\");\n        i0.ɵɵtext(16, \"Email: \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(17);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(18, \"h3\")(19, \"b\");\n        i0.ɵɵtext(20, \"Birthday: \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(21);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(22, \"br\");\n        i0.ɵɵelementStart(23, \"button\", 4);\n        i0.ɵɵlistener(\"click\", function ProfileViewComponent_Template_button_click_23_listener() {\n          return ctx.openEditUserProfile();\n        });\n        i0.ɵɵtext(24, \" Edit Profile \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(25, \"button\", 5);\n        i0.ɵɵlistener(\"click\", function ProfileViewComponent_Template_button_click_25_listener() {\n          return ctx.deleteUserProfile();\n        });\n        i0.ɵɵtext(26, \" Delete Profile \");\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelementStart(27, \"div\", 6);\n        i0.ɵɵtemplate(28, ProfileViewComponent_div_28_Template, 4, 1, \"div\", 7);\n        i0.ɵɵtemplate(29, ProfileViewComponent_ng_template_29_Template, 2, 0, \"ng-template\", null, 8, i0.ɵɵtemplateRefExtractor);\n        i0.ɵɵelementEnd()();\n      }\n\n      if (rf & 2) {\n        const _r1 = i0.ɵɵreference(30);\n\n        i0.ɵɵadvance(5);\n        i0.ɵɵtextInterpolate1(\"Hello \", ctx.user.Username, \"!\");\n        i0.ɵɵadvance(8);\n        i0.ɵɵtextInterpolate(ctx.user.Username);\n        i0.ɵɵadvance(4);\n        i0.ɵɵtextInterpolate(ctx.user.Email);\n        i0.ɵɵadvance(4);\n        i0.ɵɵtextInterpolate(ctx.user.Birthday);\n        i0.ɵɵadvance(7);\n        i0.ɵɵproperty(\"ngIf\", ctx.displayElement)(\"ngIfElse\", _r1);\n      }\n    },\n    directives: [i5.NavbarComponent, i6.MatCard, i6.MatCardHeader, i6.MatCardContent, i7.MatButton, i8.NgIf, i8.NgForOf, i3.MatDialogContent, i6.MatCardTitle, i6.MatCardSubtitle],\n    styles: [\".user-info[_ngcontent-%COMP%]{padding-left:2rem;text-align:center;display:flex;flex-direction:column;padding:2rem}.moviebox[_ngcontent-%COMP%]{padding-left:2rem;text-align:center;display:flex;justify-content:center;padding:2rem}.profile-body[_ngcontent-%COMP%]{background-color:#fff;width:100%;height:100%}\"]\n  });\n  return ProfileViewComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}